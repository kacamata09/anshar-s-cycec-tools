import socket

def receive_file(filename, host, port):
    try:
        server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        server_socket.bind((host, port))
        server_socket.listen(1) 

        print(f"Try connect to {host}:{port}...")
        client_socket, client_address = server_socket.accept()
        print(f"Connect to {client_address}")

        with open(filename, 'wb') as file:
            while True:
                data = client_socket.recv(1024)
                if not data:
                    break
                file.write(data)

        client_socket.close()
        server_socket.close()
        print(f"File success accept and filename : {filename}")

    except Exception as e:
        print(f"Error: {str(e)}")

if __name__ == "__main__":
    received_filename = "received.png"

    host = '0.0.0.0' 
    port = 9999

    receive_file(received_filename, host, port)
